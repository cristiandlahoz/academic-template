\newlength{\headerBoxWidth}

\newcommand{\createHeaderBox}{
    \begin{tikzpicture}[overlay, remember picture, x=1in, y=1in, shift=(current page.north west)]
        \fill[primaryColor] (1,-0.25) rectangle (\headerBoxWidth,-0.5);
        \draw[secondaryColor, ultra thick] (0.25,-0.5) -- (6,-0.5);
    \end{tikzpicture}
}

\newcommand{\createFooterLogo}{
    \color{secondaryColor}\textbf{\institutionShortName}
}

\newcommand{\setupHeaders}[1]{
    \setlength{\headerBoxWidth}{\widthof{#1}+1.11in}
    \fancyhead{}
    \fancyfoot{}
    \fancyfoot[R]{\createFooterLogo}
    \fancyhead[L]{\createHeaderBox\color{headerTextColor}#1}
    \fancyhead[R]{\color{bodyTextColor}PÃ¡g.\ \thepage\ -~\pageref{LastPage}}
}
